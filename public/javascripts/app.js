((function(){if(!this.require){var a={},b={},c=function(f,g){var h=b[f],i=d(g,f),j;if(h)return h;if(!(j=a[i]||a[i=d(i,"./index")]))throw"module '"+f+"' not found";h={id:f,exports:{}};try{return b[f]=h.exports,j(h.exports,function(a){return c(a,e(i))},h),b[f]=h.exports}catch(k){throw delete b[f],k}},d=function(a,b){var c=[],d,e;/^\.\.?(\/|$)/.test(b)?d=[a,b].join("/").split("/"):d=b.split("/");for(var f=0,g=d.length;f<g;f++)e=d[f],e==".."?c.pop():e!="."&&e!=""&&c.push(e);return c.join("/")},e=function(a){return a.split("/").slice(0,-1).join("/")};this.require=function(a){return c(a,"")},this.require.brunch=!0,this.require.define=function(b){for(var c in b)a[c]=b[c]}}})).call(this),this.require.define({"views/collection_view":function(a,b,c){((function(){var c,d=function(a,b){return function(){return a.apply(b,arguments)}},e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c=b("views/block_view").BlockView,a.CollectionView=function(a){function e(){this.addOne=d(this.addOne,this),e.__super__.constructor.apply(this,arguments)}return f(e,a),e.prototype.id="collection",e.prototype.initialize=function(){return document.title=this.model.get("title"),this.template=b("./templates/collection/"+this.options.mode)},e.prototype.addAll=function(){return this.collection.each(this.addOne)},e.prototype.addOne=function(a){var b;return b=new c({mode:this.options.mode,model:a,collection:this.model.blocks,channel:this.model}),this.$("#blocks").append(b.render().el)},e.prototype.render=function(){return this.$el.html(this.template({channel:this.model.toJSON(),blocks:this.collection.toJSON()})),this.addAll(),this},e}(Backbone.View)})).call(this)}}),this.require.define({helpers:function(a,b,c){((function(){a.BrunchApplication=function(){function a(){var a=this;$(function(){return a.initialize(a),Backbone.history.start()})}return a.prototype.initialize=function(){return null},a.prototype.loading=function(){return{start:function(){return $("body").addClass("loading")},stop:function(){return $("body").removeClass("loading")}}},a}()})).call(this)}}),this.require.define({"collections/blocks":function(a,b,c){((function(){var c,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};c=b("models/block").Block,a.Blocks=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.model=c,b.prototype.comparator=function(a){return a.get("channel_connection").position},b.prototype.next=function(a){var b;return b=this.at(this.indexOf(a)),undefined===b||b<0?!1:this.at(this.indexOf(a)+1)},b.prototype.prev=function(a){var b;return b=this.at(this.indexOf(a)),undefined===b||b<1?!1:this.at(this.indexOf(a)-1)},b}(Backbone.Collection)})).call(this)}}),this.require.define({"models/block":function(a,b,c){((function(){var b=function(a,b){return function(){return a.apply(b,arguments)}},c=Object.prototype.hasOwnProperty,d=function(a,b){function e(){this.constructor=a}for(var d in b)c.call(b,d)&&(a[d]=b[d]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};a.Block=function(a){function c(){this.channelConnection=b(this.channelConnection,this),c.__super__.constructor.apply(this,arguments)}return d(c,a),c.prototype.initialize=function(){return this.checkIfMissingImage(),this.channelConnection()},c.prototype.checkIfMissingImage=function(){var a;a="/assets/interface/missing.png";if(this.get("image_thumb")===a)return this.set("image_thumb",null)},c.prototype.channelConnection=function(){var a=this;return this.set("channel_connection",_.find(this.get("connections"),function(a){return a.channel_id===app.router.channel.id}))},c}(Backbone.Model)})).call(this)}}),this.require.define({"models/channel":function(a,b,c){((function(){var c,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};c=b("collections/blocks").Blocks,a.Channel=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.url=function(){return"http://are.na/api/v1/channels/"+this.get("slug")+".json?callback=?"},b.prototype.maybeLoad=function(a){var b=this;return a===this.get("slug")?!0:(this.clear(),app.loading().start(),this.set("slug",a),this.set("fetching",!0),this.fetch({success:function(){return b.setupBlocks(),b.set("fetching",!1),app.loading().stop(),!0},error:function(a){return console.log("Error: "+a)}}))},b.prototype.setupBlocks=function(){return this.blocks=new c(this.get("blocks"))},b}(Backbone.Model)})).call(this)}}),this.require.define({"routers/main_router":function(a,b,c){((function(){var c,d,e,f,g=Object.prototype.hasOwnProperty,h=function(a,b){function d(){this.constructor=a}for(var c in b)g.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c=b("views/block_view").BlockView,f=b("views/single_view").SingleView,e=b("views/collection_view").CollectionView,d=b("models/channel").Channel,a.MainRouter=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.routes={"":"collection","/:slug":"collection","/:slug/mode::mode":"collection","/:slug/show::id":"single"},b.prototype.initialize=function(){return this.channel=new d},b.prototype.collection=function(a,b){var c=this;return b==null&&(b="grid"),this.channel.set({mode:"mode",mode:b}),$.when(this.channel.maybeLoad(a)).then(function(){return c.collectionView=new e({model:c.channel,collection:c.channel.blocks,mode:b}),$("body").attr("class","collection").html(c.collectionView.render().el)})},b.prototype.single=function(a,b){var c=this;return $.when(this.channel.maybeLoad(a)).then(function(){return c.singleView=new f({model:c.channel.blocks.get(b),collection:c.channel.blocks,channel:c.channel}),$("body").attr("class","single").html(c.singleView.render().el)})},b}(Backbone.Router)})).call(this)}}),this.require.define({"views/block_view":function(a,b,c){((function(){var c,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};c=b("views/lightbox_view").LightboxView,a.BlockView=function(a){function d(){d.__super__.constructor.apply(this,arguments)}return e(d,a),d.prototype.className="block",d.prototype.events={"click .enlarge":"enlarge"},d.prototype.initialize=function(){return this.template=b("./templates/single/"+this.options.mode)},d.prototype.enlarge=function(a){return a.preventDefault(),this.view=new c({model:this.model,channel:this.options.channel,mode:this.options.mode}),$("#modal").html(this.view.render().el)},d.prototype.render=function(){return this.$el.html(this.template({mode:this.options.mode,channel:this.options.channel.toJSON(),block:this.model.toJSON()})),this},d}(Backbone.View)})).call(this)}}),this.require.define({initialize:function(a,b,c){((function(){var c,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c=b("helpers").BrunchApplication,d=b("routers/main_router").MainRouter,a.Application=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.initialize=function(){return this.loading().start(),this.router=new d},b}(c),window.app=new a.Application})).call(this)}}),this.require.define({"views/lightbox_view":function(a,b,c){((function(){var c,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};c=b("./templates/single/lightbox"),a.LightboxView=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.className="lightbox",b.prototype.events={"click *":"remove"},b.prototype.initialize=function(){return console.log(this.$el),this.$el.removeClass("hide")},b.prototype.render=function(){return this.$el.html(c({channel:this.options.channel.toJSON(),block:this.model.toJSON()})),this},b}(Backbone.View)})).call(this)}}),this.require.define({"views/single_view":function(a,b,c){((function(){var c,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};d=b("./templates/single/list"),c=b("views/block_view").BlockView,a.SingleView=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.id="single",b.prototype.className="block",b.prototype.initialize=function(){return document.title=this.model.get("title")?""+this.options.channel.get("title")+": "+this.model.get("title"):this.options.channel.get("title")},b.prototype.render=function(a){return this.$el.html(d({channel:this.options.channel.toJSON(),block:this.model.toJSON(),blocks:this.collection.toJSON(),next:this.collection.next(this.model),prev:this.collection.prev(this.model)})),this},b}(c)})).call(this)}}),this.require.define({"views/templates/collection/grid":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push('<div id="modal" class="hide"></div>\n<div id="blocks" class="grid"></div>\n<h1>'),b.push(d(this.channel.title)),b.push("</h1>")})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),this.require.define({"views/templates/collection/list":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push('<div id="modal" class="hide"></div>\n<div id="blocks" class="list"></div>\n<h1>'),b.push(d(this.channel.title)),b.push("</h1>")})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),this.require.define({"views/templates/single/grid":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push('<div class="thumb">\n  '),this.block.image_thumb?(b.push('\n    <div class="image">\n      <a href="/#/'),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.block.id)),b.push('">\n        <img src="'),b.push(d(this.block.image_thumb)),b.push('" alt="'),b.push(d(this.block.title)),b.push('" />\n      </a>\n    </div>\n  ')):this.block.title?(b.push('\n    <a href="/#/'),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.block.id)),b.push('">\n      '),b.push(d(this.block.title)),b.push("\n    </a>\n  ")):(b.push('\n    <a href="/#/'),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.block.id)),b.push('">\n      Untitled\n    </a>\n  ')),b.push("\n</div>")})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),this.require.define({"views/templates/single/lightbox":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push("HELL")})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),this.require.define({"views/templates/single/list":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){if(this.prev||this.next)b.push("\n  <nav>\n    "),this.prev&&(b.push('\n      <a href="/#/'),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.prev.id)),b.push('">Previous</a>\n    ')),b.push("\n    "),this.channel.mode?(b.push('\n      <a href="/#/'),b.push(d(this.channel.slug)),b.push("/mode:"),b.push(d(this.channel.mode)),b.push('">Up</a>\n    ')):(b.push('\n      <a href="/#/'),b.push(d(this.channel.slug)),b.push('">Up</a>\n    ')),b.push("\n    "),this.next&&(b.push('\n      <a href="/#/'),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.next.id)),b.push('">Next</a>\n    ')),b.push("\n  </nav>\n");b.push('\n\n<div id="block_'),b.push(d(this.block.id)),b.push('" class="full '),b.push(d(this.block.block_type.toLowerCase())),b.push('" data-type="'),b.push(d(this.block.block_type)),b.push('">\n\n  <!-- TYPE-SPECIFIC OUTPUT: -->\n  '),this.block.block_type==="Media"?(b.push('\n    <!-- MEDIA -->\n    <div class="embed">\n      '),this.block.embed_html?(b.push("\n        "),b.push(this.block.embed_html),b.push("\n      ")):(b.push('\n        <a href="'),b.push(d(this.block.embed_source_url)),b.push('" class="url external">\n          '),b.push(d(this.block.embed_source_url)),b.push("\n        </a>\n      ")),b.push("\n    </div>\n  ")):this.block.block_type==="Image"?(b.push('\n    <!-- IMAGE -->\n    <a href="'),b.push(d(this.block.image_original)),b.push('" class="enlarge">\n      <img src="'),b.push(d(this.block.image_display)),b.push('" alt="'),b.push(d(this.block.title)),b.push('" />\n    </a>\n  ')):this.block.block_type==="Link"?(b.push("\n    <!-- LINK -->\n    "),this.block.image_display?(b.push('\n      <a href="'),b.push(d(this.block.link_url)),b.push('" class="external" target="_blank">\n        <img src="'),b.push(d(this.block.image_display)),b.push('" alt="'),b.push(d(this.block.title)),b.push('" />\n      </a>\n    ')):(b.push('\n      <p>\n        <a href="'),b.push(d(this.block.link_url)),b.push('" class="external url" target="_blank">'),b.push(d(this.block.link_url)),b.push("</a>\n      </p>\n    ")),b.push("\n  ")):this.block.block_type==="Text"&&(b.push('\n    <!-- TEXT -->\n    <div class="content">\n      '),b.push(this.block.content),b.push("\n    </div>\n  ")),b.push('\n\n  <!-- UNIVERSAL OUTPUT: -->\n  <div class="metadata">\n    <h3 class="title">\n      <a href="/#/'),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.block.id)),b.push('">\n      '),this.block.title?(b.push("\n        "),b.push(d(this.block.title)),b.push("\n      ")):b.push("\n        Untitled\n      "),b.push("\n      </a>\n    </h3>\n\n    "),this.block.block_type!=="Text"&&!!this.block.content&&(b.push('\n      <div class="description">\n        <div class="content">\n          '),b.push(this.block.content),b.push("\n        </div>\n      </div>\n    ")),b.push("\n\n    <dl class='small meta block_meta'>\n      "),this.block.link_url&&(b.push('\n        <dt>URL:</dt>\n        <dd><a href="'),b.push(d(this.block.link_url)),b.push('" target="_blank">'),b.push(d(this.block.link_url)),b.push("</a></dd>\n      ")),b.push("\n\n      "),this.block.image_remote_url&&(b.push('\n        <dt>Source:</dt>\n        <dd><a href="'),b.push(d(this.block.image_remote_url)),b.push('" class="url external" target="_blank">'),b.push(d(this.block.image_remote_url)),b.push("</a></dd>\n      ")),b.push("\n      \n      "),this.block.embed_source_url&&(b.push('\n        <dt>Source:</dt>\n        <dd><a href="'),b.push(d(this.block.embed_source_url)),b.push('" class="url external" target="_blank">'),b.push(d(this.block.embed_source_url)),b.push("</a></dd>\n      ")),b.push("\n\n      <dt>Added by:</dt>\n      <dd>"),b.push(d(this.block.username)),b.push("</dd>\n    </dl>\n  </div>\n  \n</div><!-- #block -->")})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}})